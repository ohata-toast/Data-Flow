## Data & Analytics > DataFlow > コンソール使用ガイド

DataFlowは、次の順序で使用できます。

* サービスの有効化
    1. プロジェクトを作成します。
    2. プロジェクトを選択します。
    3. DataFlowを有効にします。
* フローの実行
    1. 名前と説明を入力してフローを作成します。
    2. 必要なノードを追加し、設定値を入力して各ノードの動作方式を定義します。
    3. ノード接続によりノードの動作順序を決定してフローが完成します。
    4. フローを実行します。
    5. ログ情報を確認してフローが正常に実行されたことを確認します。

## 管理

フローメタデータ情報を照会、管理するページです。
**Data & Analytics > DataFlow > 管理**をクリックします。

![management_main.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_main_2025_08.png)

### 検索

与えられた基準でフローを検索します。

* フロー名を基準に検索すると、名前に検索ワードが含まれたフローを検索します。

### フィルタ

与えられた条件でフローを検索します。

* フロー状態値に基づいたフィルタリングオプションを提供します。

### フローリスト

照会結果フローをテーブル形式で表示します。

* 簡単なフローメタデータと現在のフロー実行状態を表示します。
* 最近の修正日を基準にソートします。
* フローを選択してフローの変更、フロー詳細表示、フローの開始などの管理機能を使用できます。
* フィルタ条件機能を利用して特定状態のフローのみ照会できます。
* 一度照会したフローは**更新**を押すと照会結果を更新します。
* 1ページ当り12個のフローを照会し、**前へ**および**次へ**をクリックしてページを移動できます。

#### フロー状態情報

| フロー実行状態                                      | 説明 |
|---------------------------------------------------| --- |
| START\_FAILED  | フロー実行リクエストに失敗しました。 |
| QUOTA\_EXCEEDED | フロー実行のためのリソースが足りないため実行に失敗しました。 |
| STARTING       | フロー実行のためのリソースを確保中です。 |
| PREPARING      | フロー実行準備が完了しました。 |
| RUNNING        | フローが実行中です。 |
| ERROR              | フロー実行プロセスで通信障害または認証不可などによりエラーが発生しました。継続的に<b>ERROR</b>が発生する場合はサポートにお問い合わせください。 |
| STOP\_FAILED   | フロー終了リクエストに失敗しました。 |
| STOPPED        | フローが終了しました。 |
| DRAINING       | フローがドレイン中です。 |
| UNKNOWN            | フロー実行プロセスで原因不明のエラーが発生しました。継続的に<b>UNKNOWN</b>が発生する場合はサポートにお問い合わせください。 |

#### フロー状態変更通知メール
* 通知対象のフロー状態が変更されたときに、通知メールを受信できます。
* 通知対象フロー状態
    * RUNNING
    * ERROR
    * STOPPED
* 基本受信対象
    * 使用中のDataFlowサービスが有効になっているプロジェクトの**DataFlow ADMIN**ロールを持つメンバー


### フローの作成

フローを定義するメタデータを作成します。

* フロー識別のために名前と説明を追加してフローメタデータを作成します。
* フロー名は、他のフローと重複できます。
* フローテンプレートを指定してユーザーが必要な機能のフローを簡単に呼び出せます。
* フローを実行するためのインスタンスタイプを設定できます。

### フローの変更

フローのメタデータを修正します。

* 既存のフロー名と説明を修正してフローメタデータに反映します。
* フローテンプレートは指定できません。
* フローの実行中にもフローの変更が可能です。
* フローを実行するためのインスタンスタイプを変更できます。
    * ただし、変更されたインスタンスタイプは次のフロー実行から適用されます。

### フローのコピー

既存のフロー定義から新しいメタデータを作成します。

* 既存フローの名前に`_copy`文言が追加された新しいメタデータを作成します。
* 既存フローが持つフローロジックをそのままコピーします。
* 実行中のフローもコピーが可能です。
* 実行中のフローは停止状態でコピーします。
* フローの現在保存状態が一時保存の場合、既存フローの最後の保存バージョンはコピーしません。
* スケジューラが登録されたフローをコピーしても、コピーしたフローはスケジューラが登録されません。
* コピーしたフローは既存フローと完全に別のフローです。

### フローの削除

フローメタデータを削除します。

* フローメタデータを完全に削除します。
* 削除したフローは復元できません。
* 実行中のフローは削除できません。

### さらに表示 - フロー開始
停止状態のフローを開始します。

* 各フローは同時に1つのみ実行できます。
* 一時保存したフローは、最後に保存したバージョンで開始します。
* 一度も保存せず、一時保存だけしたフローは開始できません。
* フローを開始するには、必ず1回以上保存する必要があります。
* フローがスケジューラにより実行中であっても、ユーザーにより開始したフローと同じようにフローを開始できません。

### さらに表示 - フローの終了
* 実行準備中、実行中、ドレイン中のフローを終了できます。
* 残留イベントは処理せずに終了します。

### さらに表示 - フロードレイン後に終了
* 実行中のフローをドレイン後に終了できます。
* ドレインはフローの残余イベントを処理することを意味します。
* タイムアウト時間を超えた場合、ドレインが終了していなくても終了します。
* タイムアウト時間が残っている状態でドレインが終了した場合、すぐに終了します。
* ドレイン中のフローはフロー終了ですぐに終了できます。

## フロー詳細表示

選択したフローの詳細情報を確認する詳細ページです。
**Data & Analytics > DataFlow > 管理 > フローリストの中から1つ**をクリックします。
フローリスト領域とフロー詳細表示領域の境界を動かして画面比率を調整できます。
またフロー詳細表示領域の右上にある領域サイズ調節アイコンをクリックして指定された画面比率に調整できます。

### 基本情報

詳細なフローメタデータを表示します。

![management_basicinfo.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_basicinfo_2025_08.png)

* フロー作成時に入力した名前と説明情報を表示します。
* フロー作成日とコンストラクタ名をはじめ、最近の修正日/修正者、最近の実行日/実行者情報を表示します。
* 直近に実行した時点の総実行時間を表示します。
* 直近に実行した時点のインスタンスタイプを表示します。

### 基本情報 - 最近のログ

* 最近のログから現在実行中のフローのログ情報を直接確認できます。
* 過去15分のログを確認できます。

### 基本情報 - 全体ログ
* Log & Crash Searchを連動した場合、Log & Crash Searchでフローログを照会するためのLucene Queryをコピーできます。

### 基本情報 - インスタンスタイプ

* フローを実行するためのインスタンスタイプを確認して変更できます。
    * ただし、変更されたインスタンスタイプは次のフロー実行から反映されます。

### フロー情報

フローロジックを定義します。

![management_detail.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_detail_2025_08.png)

* フロー設定からノードタイプまたはテンプレートからフローコンポーネントを呼び出してフローを定義します。
    * 折りたたみおよび展開アイコンをクリックしてフロー画面を拡張または縮小できます。
* フロー画面を操作してフローを定義し、グラフの構成を変更します。
    * 各ノードに適切な設定値を入力してノードの動作を定義します。
        * [ノード詳細ガイドリンク](https://docs.toast.com/ko/Data%20&%20Analytics/DataFlow/ko/node-config-guide/)
    * ノード間に接続線を接続してメッセージのフローを定義します。
        * 各フローは必ず1つのDirected Acyclic Graph(DAG)のみ定義できます。
        * ノードのタイプ別カテゴリーに合った接続が漏れなく定義されている時のみ保存できます。
        * 1つのノードは複数の接続を持つことができます。
            * 入力接続が複数ある場合は、各接続のメッセージが単一のフローとして処理されます。
            * 出力接続が複数ある場合にはノードが出力するメッセージをすべての接続に複製してフローを作成します。
* 倍率調整と初期化、画面調整、ノードソートにより、フローが画面によく見えるように調整できます。
    * 倍率調整
        * フローグラフが表示される画面の倍率を調整します。
        * 0.5倍～2倍までの倍率をサポートします。
    * 初期化
        * 倍率調整で調整した倍率を1倍に調整します。
    * 画面調整
        * フローが1つの画面に表示されるように倍率および画面の中心を調整します。
    * ノードのソート
        * フローの配列を段階がきちんと表示されるようにソートします。
        * フローが1つの画面に表示されるように倍率および画面の中心を調整します。
* 編集したフロー定義をキャンセル/保存/一時保存できます。
    * キャンセル
        * 編集したフロー定義を最後に保存/一時保存した時の状態に戻します。
    * 一時保存
        * フローを未完成の形で保存する機能を提供します。
        * 一時保存したフローは開始できません。
        * フローを一時保存しても最後に保存した時点に戻すことはできません。
        * 一時保存時にコミット名を入力して、どのような変更があったのかを記録できます。
    * 保存
        * フローの完成度を静的に評価して保存します。
        * フローの完成度評価に合格しなかった場合、保存リクエストに失敗し、失敗理由を表示します。
        * 保存したフローは開始リクエストが可能です。
        * 保存時にコミット名を入力して、どのような変更があったのかを記録できます。

### 修正履歴

フローを修正した履歴を表示します。

![management_flowhistory.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_flowhistory_2025_08.png)

* 修正した日付とユーザー情報を表示します。
* 保存/一時保存時に入力したコミット名を表示します。
* 当時保存された方式が保存/一時保存のうち、どのような方式だったのかを表示します。

### 実行履歴

フロー開始/終了リクエストした履歴を表示します。

![management_actionhistory.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_actionhistory_2025_08.png)

* 実行した日付とユーザー情報を表示します。
* リクエストした動作を表示します。
* リクエストした動作によりフローがどのような状態であるかを表示します。
* 実行時のインスタンスタイプを表示します。
* 実行中のフローの場合、新しいウィンドウでフローの詳細状態を確認できます。

### スケジュール一覧

![management_schedulelist.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/management_schedulelist_2025_08.png)

* 左上の**Cloud Schedulerへ移動**ボタンから、新しいウィンドウでスケジュールを登録できます。
* Cloud Schedulerを通じて登録されたフローのスケジュール一覧を表示します。
* スケジュール名、対象テンプレート名、実行タイプ、開始日時、終了日時、有効化ステータスを表示します。
* スケジュール名の右側にあるボタンから、新しいウィンドウで該当スケジュールの詳細情報を確認できます。

!!! danger "注意"
    Flowと同一プロジェクト内のCloud Schedulerで登録したスケジュールのみが表示されます。
    他のプロジェクトのCloud Schedulerで登録したスケジュールは表示されません。
    
## モニタリング

実行中のフローまたはノードのモニタリング情報を表示します。
**Data & Analytics > DataFlow > モニタリング**をクリックします。
フロー画面領域とモニタリング領域の境界を動かして画面比率を調整できます。
またモニタリング領域の右上にある領域サイズ調節アイコンをクリックして、指定された画面比率に調整できます。

![monitoring.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/monitoring_2025_08.png)

### フローリスト

モニタリング可能なフローリストを表示します。

* 詳細なモニタリング情報を確認するためにフローを選択できます。
* フローのリストツリーを拡張してフローに含まれる各ノードを選択して詳細なモニタリング情報を確認できます。
* リストを折りたたんでモニタリング詳細ページ領域を拡張できます。
* **削除されたフローも表示**ボタンを押して、削除されたフローのモニタリング情報も確認できます。

### フロー画面領域

フローの外観を表示する領域です。

* 現在実行中のフローの全体的なグラフを表示します。
* ノードを選択してノードに特化したモニタリング情報を確認できます。
* 全体的なグラフが好みの位置に来るようにフロー画面を調整できます。

### モニタリング領域

モニタリングチャートを表示する領域です。

* 選択されたフローまたはノードのモニタリング情報をチャートで確認できます。
* 倍率調整と初期化により、フローが画面によく見えるように調整できます。
    * 倍率調整
        * フローグラフが表示される画面の倍率を調整します。
        * 0.5倍～2倍までの倍率をサポートします。
    * 初期化
        * 倍率調整で調整した倍率を1倍に調整します。
* チャート期間の選択
    * 期間の一括調整
        * ボタントグルにより、チャートの拡大動作をすべてのチャートに同期できます。
    * 現在時間
        * チャート期間を現在時間に設定します。
    * 期間の選択
        * モニタリング情報を確認する期間を選択します。
        * 更新設定でモニタリング情報の更新周期を選択します。
        * **キャンセル**をクリックして変更する期間を適用しない場合があります。
    * チャート
        * チャートの範囲を指定してチャートを拡大/縮小できます。

## テンプレート

テンプレートメタデータ情報を照会、作成および修正するページです。
**Data & Analytics > DataFlow > テンプレート**をクリックします。

![template_main.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/template_main_2025_08.png)

### 検索

指定された基準でテンプレートを検索します。

* テンプレート名で検索すると、名前に検索ワードが含まれるテンプレートを検索します。

### テンプレートの照会

照会結果テンプレートをテーブル形式で表示します。

* 簡単なテンプレートメタデータを表示します。
* 最近の修正日を基準にソートします。
* テンプレートを選択して、テンプレートの変更、テンプレート詳細表示などの機能を使用できます。
* 一度照会されたテンプレートは、更新を押すと照会結果が更新されます。
* 1ページあたり12個のテンプレートを照会し、**前へ**または**次へ**をクリックしてページを移動できます。

### テンプレートの作成

テンプレートを定義するメタデータを作成します。

* テンプレートを識別するために名前と説明を追加してテンプレートメタデータを作成します。
* テンプレート名は、他のテンプレート名と重複できます。
* フローテンプレートは指定できません。
* 作成されたテンプレートは、フローまたはテンプレートロジック定義時にノードタイプリストで確認できます。

### テンプレートの変更

テンプレートのメタデータを修正します。

* 既存のテンプレート名と説明を修正してテンプレートメタデータに反映します。
* フローテンプレートは指定できません。

### テンプレートのコピー

既存のテンプレート定義を利用して新しいメタデータを作成します。

* 既存テンプレートの名前に`_copy`文言が追加された新しいメタデータを作成します。
* 既存テンプレートが持つフローロジックをそのままコピーします。
* コピーしたテンプレートは既存テンプレートと完全に別のテンプレートです。

### テンプレートの削除

テンプレートメタデータを削除します。

* テンプレートメタデータを完全に削除します。
* 削除したテンプレートは復元できません。

## テンプレートの詳細表示

選択したフローの詳細情報を確認する詳細ページです。
**Data & Analytics > DataFlow > テンプレート > テンプレートリストの中から1つ**をクリックします。
テンプレートリスト領域とテンプレート詳細表示領域の境界を動かして画面比率を調整できます。
またテンプレート詳細表示領域の右上にある領域サイズ調節アイコンをクリックして、指定された画面比率に調整できます。

![template_detail.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/template_detail_2025_08.png)

### テンプレート情報

テンプレートロジックを定義します。

* テンプレート設定からノードタイプまたはテンプレートからフローコンポーネントを呼び出してテンプレートを定義します。
    * **折りたたみ**および**展開**をクリックしてテンプレート画面を拡張または縮小できます。
* テンプレート画面を操作してテンプレートを定義し、グラフの構成を変更します。
    * テンプレートはフローとは異なり、未完成のフローを自由に保存できます。
* 倍率調整と初期化、画面調整、ノードソートにより、フローが画面によく見えるように調整できます。
    * 倍率調整
        * フローグラフが表示される画面の倍率を調整します。
        * 0.5倍～2倍までの倍率をサポートします。
    * 初期化
        * 倍率調整で調整した倍率を1倍に調整します。
    * 画面調整
        * フローが1つの画面に表示されるように倍率および画面の中心を調整します。
    * ノードのソート
        * フローの配列を段階がきちんと表示されるようにソートします。
        * フローが1つの画面に表示されるように倍率および画面の中心を調整します。
* 編集したフロー定義をキャンセル/保存できます。
    * キャンセル
        * 編集したテンプレート定義を最後に保存/一時保存した時の状態に戻します。
    * 保存
        * フローを未完成の形で保存できます。
        * 保存したテンプレートはノードタイプのテンプレートカテゴリーから読み込むことができます。
## 設定
サービスに必要な設定を管理するためのページです。
**Data & Analytics > DataFlow > 設定**をクリックします。

### Log & Crash Search設定
ユーザーのフローログをユーザーが設定したLog & Crash Searchと連動する機能です。
Log & Crash Searchサービスにログを保存するには、Log & Crash Searchサービスを有効にする必要があり、別途利用料金が発生します。


![settings_lncs_v2.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/settings_lncs_v2.png)

① **Log & Crash Search保存設定**をクリックします。
②ログを保存するLog & Crash Search **Appkey**キーと保存する**ログレベル**を入力します。
③ **保存**を押して設定を完了します。
④ Log & Crash Search連動機能を使用したくない場合は、**削除**を押して保存情報を削除します。

* ログフィールド

|          名前 |                           説明 |
|---------------|--------------------------------|
|       logLevel | ログレベル(INFO, WARN, ERROR, FATAL) |
|      logSource |                          `Flow` |
|           host |                      `DataFlow` |
|         appkey |                 DataFlowサービスアプリケーションキー |
|         flowId |                       フローid |
| flowInstanceId |                  フローインスタンスid |

### 有効性検査設定
![settings_acc.png](http://static.toastoven.net/prod_dataflow/ko/console_user_guide/settings_acc.png)

フローとノードの有効性検査を使用するかどうかを設定できます。
有効性検査を**使用しない**に設定する場合、フロー保存時にノード有効性検査を自動的に行わず、ノードごとの検証機能を使用できません。
